/*
Query the EBA_COUNTRIES table to return values for the total population grouped by REGION_ID, SUB_REGION_ID and
ORGANIZATION_REGION_ID, ensure all null value IDâ€™s are populated with 0 instead of null.

I would like you to show sub totals for the following combinations only:
REGION_ID and SUB_REGION_ID,
SUB_REGION_ID and ORGANIZATION_REGION_ID
*/
-- My Solution:
SELECT
    NVL(REGION_ID, 0)              AS REGION_ID
  , NVL(SUB_REGION_ID, 0)          AS SUB_REGION_ID
  , NVL(ORGANIZATION_REGION_ID, 0) AS ORGANIZATION_REGION_ID
  , SUM(POPULATION)                AS TOTAL_POPULATION
FROM
    EBA_COUNTRIES
GROUP BY
    ROLLUP (REGION_ID, SUB_REGION_ID, ORGANIZATION_REGION_ID)
HAVING
    (REGION_ID IS NOT NULL AND SUB_REGION_ID IS NOT NULL AND ORGANIZATION_REGION_ID IS NULL) OR
    (REGION_ID IS NULL AND SUB_REGION_ID IS NOT NULL AND ORGANIZATION_REGION_ID IS NOT NULL) OR
    (REGION_ID IS NOT NULL AND SUB_REGION_ID IS NOT NULL AND ORGANIZATION_REGION_ID IS NOT NULL)
ORDER BY
    REGION_ID,
    SUB_REGION_ID,
    ORGANIZATION_REGION_ID;

-- Solution Teacher:
SELECT
    NVL(REGION_ID, 0)
  , NVL(SUB_REGION_ID, 0)
  , NVL(ORGANIZATION_REGION_ID, 0)
  , SUM(POPULATION)
FROM
    EBA_COUNTRIES
GROUP BY
    GROUPING SETS (
        (NVL(REGION_ID, 0), NVL(ORGANIZATION_REGION_ID, 0)),
        (NVL(SUB_REGION_ID, 0), NVL(ORGANIZATION_REGION_ID, 0))
    );